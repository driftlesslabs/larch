
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>&lt;no title&gt; &#8212; v6.0.37.dev16+g8c0943e</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=9d77a3fd" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=c73c0f3e"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/swissmetro/151-swissmetro-panel-latent-class';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://raw.githubusercontent.com/driftlesslabs/larch/docs/docs/switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '6.0';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            false;
        </script>
    <link rel="icon" href="../../_static/larch_favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Exampville Simulator" href="../exampville/index.html" />
    <link rel="prev" title="109: Swissmetro Nested Logit Mode Choice" href="109-swissmetro-nl.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search these docs..."
         aria-label="Search these docs..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/larch-logo.png" class="logo__image only-light" alt="v6.0.37.dev16+g8c0943e - Home"/>
    <img src="../../_static/larch-logo.png" class="logo__image only-dark pst-js-only" alt="v6.0.37.dev16+g8c0943e - Home"/>
  
  
</a></div>
    
      <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user-guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/index.html">
    API
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Examples
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user-guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/index.html">
    API
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Examples
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../mtc/index.html">MTC Examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../mtc/001_mnl.html">1: MTC MNL Mode Choice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mtc/002_motorized.html">2: Income Effect on Motorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mtc/003_zeroed_shared.html">3: Income Effect only on Non-Car</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mtc/005_motorized_travel_time.html">5: Motorized Travel Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mtc/006_motorized_times.html">6: Motorized IVTT and OVTT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mtc/007_ovtt_by_distance.html">7: Diminishing OVTT by Distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mtc/008_ttr.html">8: Constrained Travel Time Ratio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mtc/009_ttr_4.html">9: Travel Time Ratio of 4.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mtc/010_auto_per_hh.html">10: Number of Automobiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mtc/011_veh_per_worker.html">11: Vehicles per Worker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mtc/012_autos_per_adult.html">12: Vehicles per Adult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mtc/013_cbd.html">13: Destination in CBD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mtc/014_work_zone_density.html">14: Work Zone Density</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mtc/015_cbd_and_work_density.html">15: CBD and Work Zone Density</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mtc/016_cost_by_income.html">16: Cost by Income</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mtc/017A_market_seg.html">17A: Market Segmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mtc/017B_alt_segmentation.html">17B: Alternative Segmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mtc/017C_segmentation_males.html">17C: Gender Segmentation (Male)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mtc/017D_segmentation_female.html">17D: Gender Segmentation (Female)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mtc/017_mnl.html">17: MTC Expanded MNL Mode Choice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mtc/022_nl.html">22: MTC Motorized and Non-Motorized Nested Mode Choice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mtc/030_mnl_constrain.html">30: MTC MNL Constrained Mode Choice</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="index.html">Swissmetro Examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="101_swissmetro_mnl.html">101: Swissmetro MNL Mode Choice</a></li>
<li class="toctree-l2"><a class="reference internal" href="102-swissmetro-weighted.html">102: Swissmetro Weighted MNL Mode Choice</a></li>
<li class="toctree-l2"><a class="reference internal" href="109-swissmetro-nl.html">109: Swissmetro Nested Logit Mode Choice</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../exampville/index.html">Exampville Simulator</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../exampville/200_exampville.html">200: Exampville Simulated Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exampville/201_exville_mode_choice.html">201: Exampville Mode Choice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exampville/202_exville_mc_logsums.html">202: Exampville Mode Choice Logsums</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exampville/203_exville_dest.html">203: Exampville Destination Choice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exampville/204_exville_dest_only.html">204: Exampville Destination Choice without Logsums</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../vehicle/index.html">Vehicle Choice Examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../vehicle/300_veh_type.html">Vehicle Choice Mixed Logit</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Examples</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Swissmetro Examples</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">&lt;no title&gt;</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pytest</span><span class="w"> </span><span class="kn">import</span> <span class="n">approx</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">larch</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">lx</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">larch</span><span class="w"> </span><span class="kn">import</span> <span class="n">P</span><span class="p">,</span> <span class="n">X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="kn">from</span><span class="w"> </span><span class="nn">pytest</span><span class="w"> </span><span class="kn">import</span> <span class="n">approx</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="kn">import</span><span class="w"> </span><span class="nn">larch</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">lx</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="kn">from</span><span class="w"> </span><span class="nn">larch</span><span class="w"> </span><span class="kn">import</span> <span class="n">P</span><span class="p">,</span> <span class="n">X</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;pytest&#39;
</pre></div>
</div>
</div>
</div>
<p>This example is a latent class mode choice model (also known as a discrete mixture model) built using the Swissmetro example dataset.
This model is similar to the simple latent class model shown in <a class="reference internal" href="107-swissmetro-latent-class.html"><span class="doc std std-doc">Example 107</span></a>. The key difference is
that the class membership is determined per-respondent instead of per-observation. The underlying data is from a stated preference
survey, where respondents made repeated choices with various different alternative attributes.</p>
<p>As before, the first step is to load the data and do some pre-processing, so that the format and scale of the
data matches that from the Biogeme example.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">lx</span><span class="o">.</span><span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;swissmetro.csv.gz&quot;</span><span class="p">))</span>
<span class="n">raw</span><span class="p">[</span><span class="s2">&quot;SM_COST&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw</span><span class="p">[</span><span class="s2">&quot;SM_CO&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">raw</span><span class="p">[</span><span class="s2">&quot;GA&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">raw</span><span class="p">[</span><span class="s2">&quot;TRAIN_COST&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s2">&quot;TRAIN_CO * (GA == 0)&quot;</span><span class="p">)</span>
<span class="n">raw</span><span class="p">[</span><span class="s2">&quot;TRAIN_COST_SCALED&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw</span><span class="p">[</span><span class="s2">&quot;TRAIN_COST&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span>
<span class="n">raw</span><span class="p">[</span><span class="s2">&quot;TRAIN_TT_SCALED&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw</span><span class="p">[</span><span class="s2">&quot;TRAIN_TT&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span>
<span class="n">raw</span><span class="p">[</span><span class="s2">&quot;SM_COST_SCALED&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s2">&quot;SM_COST / 100&quot;</span><span class="p">)</span>
<span class="n">raw</span><span class="p">[</span><span class="s2">&quot;SM_TT_SCALED&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw</span><span class="p">[</span><span class="s2">&quot;SM_TT&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span>
<span class="n">raw</span><span class="p">[</span><span class="s2">&quot;CAR_CO_SCALED&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw</span><span class="p">[</span><span class="s2">&quot;CAR_CO&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span>
<span class="n">raw</span><span class="p">[</span><span class="s2">&quot;CAR_TT_SCALED&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw</span><span class="p">[</span><span class="s2">&quot;CAR_TT&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span>
<span class="n">raw</span><span class="p">[</span><span class="s2">&quot;CAR_AV_SP&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s2">&quot;CAR_AV * (SP!=0)&quot;</span><span class="p">)</span>
<span class="n">raw</span><span class="p">[</span><span class="s2">&quot;TRAIN_AV_SP&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s2">&quot;TRAIN_AV * (SP!=0)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">lx</span><span class="o">.</span><span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;swissmetro.csv.gz&quot;</span><span class="p">))</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">raw</span><span class="p">[</span><span class="s2">&quot;SM_COST&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw</span><span class="p">[</span><span class="s2">&quot;SM_CO&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">raw</span><span class="p">[</span><span class="s2">&quot;GA&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">raw</span><span class="p">[</span><span class="s2">&quot;TRAIN_COST&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s2">&quot;TRAIN_CO * (GA == 0)&quot;</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;lx&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raw</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">raw</span>

<span class="ne">NameError</span>: name &#39;raw&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>We now have a pandas DataFrame in “wide” or <a class="reference internal" href="../../user-guide/data-fundamentals.html#idco"><span class="std std-ref">idco</span></a> format, with one row per choice observation.
For this example, it is relevant to note there is more than one row per respondent, and the various
respondents can be identified by the “ID” column.</p>
<p>We can convert this to a Larch Dataset, filtering to include only the cases of interest,
following the same filter applied in the Biogeme example.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">lx</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">construct</span><span class="o">.</span><span class="n">from_idco</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span><span class="o">.</span><span class="n">dc</span><span class="o">.</span><span class="n">query_cases</span><span class="p">(</span><span class="s2">&quot;PURPOSE in (1,3) and CHOICE != 0&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="nn">----&gt; 1 data = lx.Dataset.construct.from_idco(raw).dc.query_cases(&quot;PURPOSE</span> in <span class="nt">(1,3) and CHOICE != 0&quot;)</span>

<span class="ne">NameError</span>: name &#39;lx&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>The result is a Dataset with 6,768 cases.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">data</span>

<span class="ne">NameError</span>: name &#39;data&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>For convenience, we can collect the names of the variables that define alternative availability
into a dictionary, keyed on the codes we will use to represent each alternative.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">availability_co_vars</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;TRAIN_AV_SP&quot;</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;SM_AV&quot;</span><span class="p">,</span>
    <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;CAR_AV_SP&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Then we can contruct choice models for each of the classes.  This is done in the
usual manner for Larch choice models, assigning utility functions, alternative
availability conditions, and choice markers in the usual manner.</p>
<p>In this example, Class 1 chooses based on cost, and the utility functions include
a set of alternative specific constants.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m1</span> <span class="o">=</span> <span class="n">lx</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Model1&quot;</span><span class="p">)</span>
<span class="n">m1</span><span class="o">.</span><span class="n">availability_co_vars</span> <span class="o">=</span> <span class="n">availability_co_vars</span>
<span class="n">m1</span><span class="o">.</span><span class="n">choice_co_code</span> <span class="o">=</span> <span class="s2">&quot;CHOICE&quot;</span>
<span class="n">m1</span><span class="o">.</span><span class="n">utility_co</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="s2">&quot;ASC_TRAIN&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">X</span><span class="p">(</span><span class="s2">&quot;TRAIN_COST_SCALED&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">P</span><span class="p">(</span><span class="s2">&quot;B_COST&quot;</span><span class="p">)</span>
<span class="n">m1</span><span class="o">.</span><span class="n">utility_co</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="s2">&quot;SM_COST_SCALED&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">P</span><span class="p">(</span><span class="s2">&quot;B_COST&quot;</span><span class="p">)</span>
<span class="n">m1</span><span class="o">.</span><span class="n">utility_co</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="s2">&quot;ASC_CAR&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">X</span><span class="p">(</span><span class="s2">&quot;CAR_CO_SCALED&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">P</span><span class="p">(</span><span class="s2">&quot;B_COST&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">m1</span> <span class="o">=</span> <span class="n">lx</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Model1&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">m1</span><span class="o">.</span><span class="n">availability_co_vars</span> <span class="o">=</span> <span class="n">availability_co_vars</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">m1</span><span class="o">.</span><span class="n">choice_co_code</span> <span class="o">=</span> <span class="s2">&quot;CHOICE&quot;</span>

<span class="ne">NameError</span>: name &#39;lx&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Class 2 is the nearly same model, defined completely seperately but in a similar manner.
The only difference is in the utility functions, which adds travel time to the utility.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m2</span> <span class="o">=</span> <span class="n">lx</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Model2&quot;</span><span class="p">)</span>
<span class="n">m2</span><span class="o">.</span><span class="n">availability_co_vars</span> <span class="o">=</span> <span class="n">availability_co_vars</span>
<span class="n">m2</span><span class="o">.</span><span class="n">choice_co_code</span> <span class="o">=</span> <span class="s2">&quot;CHOICE&quot;</span>
<span class="n">m2</span><span class="o">.</span><span class="n">utility_co</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">P</span><span class="p">(</span><span class="s2">&quot;ASC_TRAIN&quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">X</span><span class="p">(</span><span class="s2">&quot;TRAIN_TT_SCALED&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">P</span><span class="p">(</span><span class="s2">&quot;B_TIME&quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">X</span><span class="p">(</span><span class="s2">&quot;TRAIN_COST_SCALED&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">P</span><span class="p">(</span><span class="s2">&quot;B_COST&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">m2</span><span class="o">.</span><span class="n">utility_co</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="s2">&quot;SM_TT_SCALED&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">P</span><span class="p">(</span><span class="s2">&quot;B_TIME&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">X</span><span class="p">(</span><span class="s2">&quot;SM_COST_SCALED&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">P</span><span class="p">(</span><span class="s2">&quot;B_COST&quot;</span><span class="p">)</span>
<span class="n">m2</span><span class="o">.</span><span class="n">utility_co</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">P</span><span class="p">(</span><span class="s2">&quot;ASC_CAR&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">X</span><span class="p">(</span><span class="s2">&quot;CAR_TT_SCALED&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">P</span><span class="p">(</span><span class="s2">&quot;B_TIME&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">X</span><span class="p">(</span><span class="s2">&quot;CAR_CO_SCALED&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">P</span><span class="p">(</span><span class="s2">&quot;B_COST&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">m2</span> <span class="o">=</span> <span class="n">lx</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Model2&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">m2</span><span class="o">.</span><span class="n">availability_co_vars</span> <span class="o">=</span> <span class="n">availability_co_vars</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">m2</span><span class="o">.</span><span class="n">choice_co_code</span> <span class="o">=</span> <span class="s2">&quot;CHOICE&quot;</span>

<span class="ne">NameError</span>: name &#39;lx&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>For this example, we will also add a third choice class.
Class 3 represents a lexicographic or non-compensatory choice system, where
the choice of mode is based exclusively on cost, without regard to any other
choice attribute. When two modes have the same cost, they are considered to be
equally likely.  This lexicographic is still represented in the same mathematical
manner as the other classes that employ typical multinomial logit models, except
we will constrain the <code class="docutils literal notranslate"><span class="pre">Z_COST</span></code> parameter to enforce the desired choice rule for this
class.</p>
<p>The use of this kind of choice model in a latent class structure can be challenging
with cross-sectional data, as it is very easy to create over-specified models, i.e.
it is hard to tell from one choice observation whether a decision maker is choosing
based on a simple choice rule or considering trade-offs between various attributes.
In a panel data study as shown in this example, it is much easier to mathematically
disambiguate between compensatory and non-compensatory choice processes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m3</span> <span class="o">=</span> <span class="n">lx</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Model3&quot;</span><span class="p">)</span>
<span class="n">m3</span><span class="o">.</span><span class="n">availability_co_vars</span> <span class="o">=</span> <span class="n">availability_co_vars</span>
<span class="n">m3</span><span class="o">.</span><span class="n">choice_co_code</span> <span class="o">=</span> <span class="s2">&quot;CHOICE&quot;</span>
<span class="n">m3</span><span class="o">.</span><span class="n">utility_co</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="s2">&quot;TRAIN_COST_SCALED&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">P</span><span class="p">(</span><span class="s2">&quot;Z_COST&quot;</span><span class="p">)</span>
<span class="n">m3</span><span class="o">.</span><span class="n">utility_co</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="s2">&quot;SM_COST_SCALED&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">P</span><span class="p">(</span><span class="s2">&quot;Z_COST&quot;</span><span class="p">)</span>
<span class="n">m3</span><span class="o">.</span><span class="n">utility_co</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="s2">&quot;CAR_CO_SCALED&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">P</span><span class="p">(</span><span class="s2">&quot;Z_COST&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">m3</span> <span class="o">=</span> <span class="n">lx</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Model3&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">m3</span><span class="o">.</span><span class="n">availability_co_vars</span> <span class="o">=</span> <span class="n">availability_co_vars</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">m3</span><span class="o">.</span><span class="n">choice_co_code</span> <span class="o">=</span> <span class="s2">&quot;CHOICE&quot;</span>

<span class="ne">NameError</span>: name &#39;lx&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>The class membership model for this latent class model is relatively simple, just constants for each class.
One class (the first one, which we label as model 101) is a reference point, and the other classes are
evaluated as more or less likely than the reference, similar to a typical MNL model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mk</span> <span class="o">=</span> <span class="n">lx</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span>
<span class="n">mk</span><span class="o">.</span><span class="n">utility_co</span><span class="p">[</span><span class="mi">102</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="s2">&quot;W_OTHER&quot;</span><span class="p">)</span>
<span class="n">mk</span><span class="o">.</span><span class="n">utility_co</span><span class="p">[</span><span class="mi">103</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="s2">&quot;W_COST&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">mk</span> <span class="o">=</span> <span class="n">lx</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">mk</span><span class="o">.</span><span class="n">utility_co</span><span class="p">[</span><span class="mi">102</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="s2">&quot;W_OTHER&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">mk</span><span class="o">.</span><span class="n">utility_co</span><span class="p">[</span><span class="mi">103</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="s2">&quot;W_COST&quot;</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;lx&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Finally, we assembled all the component models into one LatentClass structure.  We add the <code class="docutils literal notranslate"><span class="pre">groupid</span></code>
argument to indicate how our panel data is structured.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">lx</span><span class="o">.</span><span class="n">LatentClass</span><span class="p">(</span>
    <span class="n">mk</span><span class="p">,</span>
    <span class="p">{</span><span class="mi">101</span><span class="p">:</span> <span class="n">m1</span><span class="p">,</span> <span class="mi">102</span><span class="p">:</span> <span class="n">m2</span><span class="p">,</span> <span class="mi">103</span><span class="p">:</span> <span class="n">m3</span><span class="p">},</span>
    <span class="n">datatree</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">dc</span><span class="o">.</span><span class="n">set_altids</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>
    <span class="n">groupid</span><span class="o">=</span><span class="s2">&quot;ID&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">b</span> <span class="o">=</span> <span class="n">lx</span><span class="o">.</span><span class="n">LatentClass</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>     <span class="n">mk</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>     <span class="p">{</span><span class="mi">101</span><span class="p">:</span> <span class="n">m1</span><span class="p">,</span> <span class="mi">102</span><span class="p">:</span> <span class="n">m2</span><span class="p">,</span> <span class="mi">103</span><span class="p">:</span> <span class="n">m3</span><span class="p">},</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="n">datatree</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">dc</span><span class="o">.</span><span class="n">set_altids</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>     <span class="n">groupid</span><span class="o">=</span><span class="s2">&quot;ID&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="p">)</span>

<span class="ne">NameError</span>: name &#39;lx&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>After creating the <code class="docutils literal notranslate"><span class="pre">LatentClass</span></code> structure, we can add contraints on parameters, such as that
needed for the lexicographic choice class.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">lock_value</span><span class="p">(</span><span class="n">Z_COST</span><span class="o">=-</span><span class="mi">10000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">13</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">b</span><span class="o">.</span><span class="n">lock_value</span><span class="p">(</span><span class="n">Z_COST</span><span class="o">=-</span><span class="mi">10000</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;b&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">set_cap</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">b</span><span class="o">.</span><span class="n">set_cap</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;b&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">maximize_loglike</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;slsqp&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">result</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">maximize_loglike</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;slsqp&quot;</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;b&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">calculate_parameter_covariance</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">18</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">b</span><span class="o">.</span><span class="n">calculate_parameter_covariance</span><span class="p">();</span>

<span class="ne">NameError</span>: name &#39;b&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">parameter_summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">b</span><span class="o">.</span><span class="n">parameter_summary</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;b&#39; is not defined
</pre></div>
</div>
</div>
</div>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="109-swissmetro-nl.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">109: Swissmetro Nested Logit Mode Choice</p>
      </div>
    </a>
    <a class="right-next"
       href="../exampville/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Exampville Simulator</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="simple visible nav section-nav flex-column">
</ul>

  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/examples/swissmetro/151-swissmetro-panel-latent-class.ipynb"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item"><!-- This will display the version of the docs -->
<p class="larch-version">🌳 Larch v6.0.37.dev16+g8c0943e, © Copyright 2024.</p></div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>