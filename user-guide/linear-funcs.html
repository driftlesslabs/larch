

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Linear Functions &#8212; .</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="icon" sizes="32x32" type="image/png" href="../_static/_img/larch_favicon.png" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'user-guide/linear-funcs';</script>
    <link rel="shortcut icon" href="../_static/larch_favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Data" href="../api/~data.html" />
    <link rel="prev" title="Data for Discrete Choice" href="data-fundamentals.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search these docs..."
         aria-label="Search these docs..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/larch-logo.png" class="logo__image only-light" alt=". - Home"/>
    <script>document.write(`<img src="../_static/larch-logo.png" class="logo__image only-dark" alt=". - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Users Guide</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installing Larch</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="choice-models.html">Choice Models</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="data-fundamentals.html">Data Fundamentals</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Linear Functions</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/~data.html">Data</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/dataset.html">Dataset</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Dataset.html">larch.Dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Dataset.construct.from_idca.html">larch.Dataset.construct.from_idca</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Dataset.construct.from_idce.html">larch.Dataset.construct.from_idce</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Dataset.construct.from_idco.html">larch.Dataset.construct.from_idco</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Dataset.construct.html">larch.Dataset.construct</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Dataset.dims.html">larch.Dataset.dims</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Dataset.sizes.html">larch.Dataset.sizes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Dataset.data_vars.html">larch.Dataset.data_vars</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Dataset.coords.html">larch.Dataset.coords</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Dataset.attrs.html">larch.Dataset.attrs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Dataset.encoding.html">larch.Dataset.encoding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Dataset.indexes.html">larch.Dataset.indexes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Dataset.chunks.html">larch.Dataset.chunks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Dataset.chunksizes.html">larch.Dataset.chunksizes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Dataset.nbytes.html">larch.Dataset.nbytes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Dataset.set_dtypes.html">larch.Dataset.set_dtypes</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/datatree.html">DataTree</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.DataTree.html">larch.DataTree</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.DataTree.root_node_name.html">larch.DataTree.root_node_name</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.DataTree.subspaces.html">larch.DataTree.subspaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.DataTree.relationships_are_digitized.html">larch.DataTree.relationships_are_digitized</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.DataTree.n_cases.html">larch.DataTree.n_cases</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.DataTree.n_alts.html">larch.DataTree.n_alts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.DataTree.CASEID.html">larch.DataTree.CASEID</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.DataTree.ALTID.html">larch.DataTree.ALTID</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.DataTree.add_dataset.html">larch.DataTree.add_dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.DataTree.add_relationship.html">larch.DataTree.add_relationship</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.DataTree.digitize_relationships.html">larch.DataTree.digitize_relationships</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.DataTree.query_cases.html">larch.DataTree.query_cases</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.DataTree.replace_datasets.html">larch.DataTree.replace_datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.DataTree.setup_flow.html">larch.DataTree.setup_flow</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/~models.html">Models</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/model.html">Model</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.html">larch.Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.datatree.html">larch.Model.datatree</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.dataset.html">larch.Model.dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.n_cases.html">larch.Model.n_cases</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.choice_ca_var.html">larch.Model.choice_ca_var</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.choice_co_vars.html">larch.Model.choice_co_vars</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.choice_co_code.html">larch.Model.choice_co_code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.availability_ca_var.html">larch.Model.availability_ca_var</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.availability_co_vars.html">larch.Model.availability_co_vars</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.utility_ca.html">larch.Model.utility_ca</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.utility_co.html">larch.Model.utility_co</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.quantity_ca.html">larch.Model.quantity_ca</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.pf.html">larch.Model.pf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.most_recent_estimation_result.html">larch.Model.most_recent_estimation_result</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.possible_overspecification.html">larch.Model.possible_overspecification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.set_values.html">larch.Model.set_values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.lock_value.html">larch.Model.lock_value</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.set_cap.html">larch.Model.set_cap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.remove_unused_parameters.html">larch.Model.remove_unused_parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.maximize_loglike.html">larch.Model.maximize_loglike</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.calculate_parameter_covariance.html">larch.Model.calculate_parameter_covariance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.loglike_null.html">larch.Model.loglike_null</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.parameter_summary.html">larch.Model.parameter_summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.estimation_statistics.html">larch.Model.estimation_statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.bhhh.html">larch.Model.bhhh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.d_loglike.html">larch.Model.d_loglike</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.d_loglike_casewise.html">larch.Model.d_loglike_casewise</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.loglike.html">larch.Model.loglike</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.loglike_casewise.html">larch.Model.loglike_casewise</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.logsums.html">larch.Model.logsums</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.probability.html">larch.Model.probability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.quantity.html">larch.Model.quantity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.total_weight.html">larch.Model.total_weight</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.Model.utility.html">larch.Model.utility</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/linear.html">Linear Functions</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/nesting.html">NestingTree</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.NestingTree.html">larch.NestingTree</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.NestingTree.new_node.html">larch.NestingTree.new_node</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.NestingTree.add_node.html">larch.NestingTree.add_node</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.NestingTree.remove_node.html">larch.NestingTree.remove_node</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.NestingTree.add_edge.html">larch.NestingTree.add_edge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/larch.NestingTree.remove_edge.html">larch.NestingTree.remove_edge</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../examples/mtc/index.html">MTC Mode Choice</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/mtc/001_mnl.html">1: MTC MNL Mode Choice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/mtc/017_mnl.html">17: MTC Expanded MNL Mode Choice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/mtc/022_nl.html">22: MTC Motorized and Non-Motorized Nested Mode Choice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/mtc/030_mnl_constrain.html">1: MTC MNL Constrained Mode Choice</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../examples/exampville/index.html">Exampville</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/exampville/200_exampville.html">200: Exampville Simulated Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/exampville/201_exville_mode_choice.html">201: Exampville Mode Choice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/exampville/202_exville_mc_logsums.html">202: Exampville Mode Choice Logsums</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/exampville/203_exville_dest.html">203: Exampville Destination Choice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/exampville/204_exville_dest_only.html">204: Exampville Destination Choice without Logsums</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/driftlesslabs/larch" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/driftlesslabs/larch/issues/new?title=Issue%20on%20page%20%2Fuser-guide/linear-funcs.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/user-guide/linear-funcs.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Linear Functions</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="linear-functions">
<span id="linear-funcs"></span><h1>Linear Functions<a class="headerlink" href="#linear-functions" title="Permalink to this heading">#</a></h1>
<p>In many discrete choice models, the
probability of selecting any particular alternative is represented as
some function based on the utility of the various alternatives.</p>
<p>In Larch, the utility is created based on one or more linear-in-parameters
functions, which combine raw or pre-computed data values with
named model parameters.  To facilitate writing these functions,
Larch provides two special classes: parameter references (<code class="docutils literal notranslate"><span class="pre">P</span></code>) and
data references (<code class="docutils literal notranslate"><span class="pre">X</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">larch</span> <span class="kn">import</span> <span class="n">P</span><span class="p">,</span> <span class="n">X</span>
</pre></div>
</div>
</div>
</div>
<p>Parameter and data references can be defined using either a function-like notation,
or a attribute-like notation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="p">(</span><span class="s2">&quot;NamedParameter&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>P.NamedParameter
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">NamedDataValue</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X.NamedDataValue
</pre></div>
</div>
</div>
</div>
<p>In either case, if the named value contains any spaces or non-alphanumeric characters,
it must be given in function-like notation only, as Python will not accept
those characters in the attribute-like form.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="p">(</span><span class="s2">&quot;Named Parameter&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>P(&#39;Named Parameter&#39;)
</pre></div>
</div>
</div>
</div>
<p>Data references can name an exact data element that appears in the data used for
model estimation or application, or can include simple transformations of that data, so long
as these transformations can be done without regard to any estimated parameter.
For example, we can use the log of income:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;log(INCOME)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X(&#39;log(INCOME)&#39;)
</pre></div>
</div>
</div>
</div>
<p>To write a linear-in-parameters utility function, we simply multiply together
a parameter reference and a data reference, and then optionally add that
to one or more similar terms.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="o">.</span><span class="n">InVehTime</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">AUTO_TIME</span> <span class="o">+</span> <span class="n">P</span><span class="o">.</span><span class="n">Cost</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">AUTO_COST</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre class="LinearFunc"><span class="LinearFunc_Param">P.InVehTime</span> * <span class="LinearFunc_Data">X.AUTO_TIME</span><br> + <span class="LinearFunc_Param">P.Cost</span> * <span class="LinearFunc_Data">X.AUTO_COST</span></pre></div></div>
</div>
<p>It is permissible to omit the data reference on a term
(in which case it is implicitly set to 1.0).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="o">.</span><span class="n">ASC</span> <span class="o">+</span> <span class="n">P</span><span class="o">.</span><span class="n">InVehTime</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">AUTO_TIME</span> <span class="o">+</span> <span class="n">P</span><span class="o">.</span><span class="n">Cost</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">AUTO_COST</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre class="LinearFunc"><span class="LinearFunc_Param">P.ASC</span><br> + <span class="LinearFunc_Param">P.InVehTime</span> * <span class="LinearFunc_Data">X.AUTO_TIME</span><br> + <span class="LinearFunc_Param">P.Cost</span> * <span class="LinearFunc_Data">X.AUTO_COST</span></pre></div></div>
</div>
<p>On the other hand, Larch does not currently permit you to omit the parameter
reference from a term.</p>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="o">.</span><span class="n">InVehTime</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">AUTO_TIME</span> <span class="o">+</span> <span class="n">P</span><span class="o">.</span><span class="n">Cost</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">AUTO_COST</span> <span class="o">+</span> <span class="n">X</span><span class="o">.</span><span class="n">GEN_COST</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NotImplementedError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">P</span><span class="o">.</span><span class="n">InVehTime</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">AUTO_TIME</span> <span class="o">+</span> <span class="n">P</span><span class="o">.</span><span class="n">Cost</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">AUTO_COST</span> <span class="o">+</span> <span class="n">X</span><span class="o">.</span><span class="n">GEN_COST</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.10.13/x64/lib/python3.10/site-packages/larch/model/linear.py:1094,</span> in <span class="ni">LinearFunction.__add__</span><span class="nt">(self, other)</span>
<span class="g g-Whitespace">   </span><span class="mi">1092</span>         <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1093</span>             <span class="k">pass</span>
<span class="ne">-&gt; </span><span class="mi">1094</span> <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">_what_is</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">_what_is</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="ne">NotImplementedError</span>: &lt;LinearFunction&gt; + X.GEN_COST
</pre></div>
</div>
</div>
</div>
<p>Although you cannot include a term with an implicit parameter set to 1,
you can achieve the same model structure by including that parameter <em>explicitly</em>.
Later in the model setup process you can explicitly lock any parameter to
have a specific fixed value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="o">.</span><span class="n">InVehTime</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">AUTO_TIME</span> <span class="o">+</span> <span class="n">P</span><span class="o">.</span><span class="n">Cost</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">AUTO_COST</span> <span class="o">+</span> <span class="n">X</span><span class="o">.</span><span class="n">GEN_COST</span> <span class="o">*</span> <span class="n">P</span><span class="o">.</span><span class="n">One</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre class="LinearFunc"><span class="LinearFunc_Param">P.InVehTime</span> * <span class="LinearFunc_Data">X.AUTO_TIME</span><br> + <span class="LinearFunc_Param">P.Cost</span> * <span class="LinearFunc_Data">X.AUTO_COST</span><br> + <span class="LinearFunc_Param">P.One</span> * <span class="LinearFunc_Data">X.GEN_COST</span></pre></div></div>
</div>
<p>In addition to writing out a linear function as a single command, you can also compose
such functions over several Python commands, using both in-place and regular addition.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">ASC</span> <span class="o">+</span> <span class="n">P</span><span class="o">.</span><span class="n">InVehTime</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">AUTO_TIME</span>
<span class="n">f</span> <span class="o">+=</span> <span class="n">P</span><span class="o">.</span><span class="n">Cost</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">AUTO_COST</span>
<span class="n">f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre class="LinearFunc"><span class="LinearFunc_Param">P.ASC</span><br> + <span class="LinearFunc_Param">P.InVehTime</span> * <span class="LinearFunc_Data">X.AUTO_TIME</span><br> + <span class="LinearFunc_Param">P.Cost</span> * <span class="LinearFunc_Data">X.AUTO_COST</span></pre></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">+</span> <span class="n">P</span><span class="o">.</span><span class="n">Cost</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">AUTO_TOLL</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre class="LinearFunc"><span class="LinearFunc_Param">P.ASC</span><br> + <span class="LinearFunc_Param">P.InVehTime</span> * <span class="LinearFunc_Data">X.AUTO_TIME</span><br> + <span class="LinearFunc_Param">P.Cost</span> * <span class="LinearFunc_Data">X.AUTO_COST</span><br> + <span class="LinearFunc_Param">P.Cost</span> * <span class="LinearFunc_Data">X.AUTO_TOLL</span></pre></div></div>
</div>
<p>Functional simplification is not automatic.  Thus, while you can subtract term from
a linear function, it does not cancel out existing terms from the function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">ASC</span> <span class="o">+</span> <span class="n">P</span><span class="o">.</span><span class="n">InVehTime</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">AUTO_TIME</span>
<span class="n">f</span> <span class="o">-</span> <span class="n">P</span><span class="o">.</span><span class="n">InVehTime</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">AUTO_TIME</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre class="LinearFunc"><span class="LinearFunc_Param">P.ASC</span><br> + <span class="LinearFunc_Param">P.InVehTime</span> * <span class="LinearFunc_Data">X.AUTO_TIME</span><br> + <span class="LinearFunc_Param">P.InVehTime</span> * -1 * <span class="LinearFunc_Data">X.AUTO_TIME</span></pre></div></div>
</div>
<p>Instead, to actually remove terms from a linear function, use the <code class="docutils literal notranslate"><span class="pre">remove_param</span></code> or <code class="docutils literal notranslate"><span class="pre">remove_data</span></code> methods.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">ASC</span> <span class="o">+</span> <span class="n">P</span><span class="o">.</span><span class="n">InVehTime</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">AUTO_TIME</span> <span class="o">+</span> <span class="n">P</span><span class="o">.</span><span class="n">Cost</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">AUTO_TOLL</span>
<span class="n">f</span><span class="o">.</span><span class="n">remove_param</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">InVehTime</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre class="LinearFunc"><span class="LinearFunc_Param">P.ASC</span><br> + <span class="LinearFunc_Param">P.Cost</span> * <span class="LinearFunc_Data">X.AUTO_TOLL</span></pre></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">ASC</span> <span class="o">+</span> <span class="n">P</span><span class="o">.</span><span class="n">InVehTime</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">AUTO_TIME</span> <span class="o">+</span> <span class="n">P</span><span class="o">.</span><span class="n">Cost</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">AUTO_TOLL</span>
<span class="n">f</span><span class="o">.</span><span class="n">remove_data</span><span class="p">(</span><span class="s2">&quot;AUTO_TOLL&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre class="LinearFunc"><span class="LinearFunc_Param">P.ASC</span><br> + <span class="LinearFunc_Param">P.InVehTime</span> * <span class="LinearFunc_Data">X.AUTO_TIME</span></pre></div></div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./user-guide"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="data-fundamentals.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Data for Discrete Choice</p>
      </div>
    </a>
    <a class="right-next"
       href="../api/~data.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Data</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jeffrey Newman
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>